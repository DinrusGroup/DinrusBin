/*******************************************************************************

        copyright:      Copyright (c) 2009 Dinrus. все rights reserved

        license:        BSD стиль: $(LICENSE)

        version:        Nov 2009: Initial release

        author:         Lukas Pinkowski, Kris

*******************************************************************************/

module net.device.LocalSocket;

private import net.device.Socket;

/*******************************************************************************


*******************************************************************************/

version (Windows)
{
        pragma(msg, "not yet available for windows");
}

/*******************************************************************************

        A wrapper around the Беркли API в_ implement the ИПровод 
        abstraction и добавь поток-specific functionality.

*******************************************************************************/

class ЛокальныйСокет : Сокет
{
        /***********************************************************************
        
                Созд a Потокing local сокет

        ***********************************************************************/

        private this ();

        /***********************************************************************
        
                Созд a Потокing local сокет

        ***********************************************************************/

        this (ткст путь);

        /***********************************************************************
        
                Созд a Потокing local сокет

        ***********************************************************************/

        this (ЛокальныйАдрес адр);

        /***********************************************************************

                Return the имя of this устройство

        ***********************************************************************/

        override ткст вТкст();
}

/*******************************************************************************


*******************************************************************************/

class СокетЛокальногоСервера : ЛокальныйСокет
{      
        /***********************************************************************

        ***********************************************************************/

        this (ткст путь, цел backlog=32, бул reuse=нет);

        /***********************************************************************

                Return the имя of this устройство

        ***********************************************************************/

        override ткст вТкст();

        /***********************************************************************

        ***********************************************************************/

        Сокет прими (Сокет реципиент = пусто);
}

/*******************************************************************************

*******************************************************************************/

class ЛокальныйАдрес : адрес
{
        align(1) struct sockAddr_un
        {
                бкрат sun_family = ПСемействоАдресов.ЮНИКС;
                сим[108] sun_path;
        }
                        
        protected
        {
                sockAddr_un sun;
                ткст _path;
                цел _pathLength;
        }

        /***********************************************************************

            -путь- путь в_ a unix домен сокет (which is a имяф)

        ***********************************************************************/

        this (ткст путь);

        /***********************************************************************

        ***********************************************************************/

        final адрессок* имя () ;
        
        /***********************************************************************

        ***********************************************************************/

        final цел длинаИмени () ;
        
        /***********************************************************************

        ***********************************************************************/

        final ПСемействоАдресов ПСемействоАдресов ();
        
        /***********************************************************************

        ***********************************************************************/

        final ткст вТкст ();
        
        /***********************************************************************

        ***********************************************************************/

        final ткст путь ();
        
        /***********************************************************************

        ***********************************************************************/

        final бул абстрактен_ли ();
}

/******************************************************************************

******************************************************************************/

debug (ЛокальныйСокет)
{
        import io.Stdout;

        проц main()
        {
                auto y = new ЛокальныйСокет ("foo");
                auto x = new СокетЛокальногоСервера ("foo");   
        }
}        